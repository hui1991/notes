## kotlin

#### 1 ä»€ä¹ˆæ˜¯kotlin
Kotlinæ˜¯ä¸€ç§åœ¨Javaè™šæ‹Ÿæœºä¸Šæ‰§è¡Œçš„é™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒç®€æ´ã€å®‰å…¨ã€å¯ä¸Javaå’Œå…¶ä»–è¯­è¨€äº’æ“ä½œ
<br>

#### 2 ä¸ºä»€ä¹ˆè¦ä½¿ç”¨kotlin
- **Android mobile development has been Kotlin-first since Google I/O in 2019**
<br>

- **Less code combined with greater readability**
  æ›´å°‘çš„ä»£ç å’Œæ›´é«˜çš„å¯è¯»æ€§
<br>

- **æ›´å®‰å…¨çš„ä»£ç **  
  ç©ºå®‰å…¨å¯ä»¥é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸  
<br>

- **å¯äº’æ“ä½œ**  
  æ‚¨å¯ä»¥åœ¨ Kotlin ä»£ç ä¸­è°ƒç”¨ Java ä»£ç ï¼Œæˆ–è€…åœ¨ Java ä»£ç ä¸­è°ƒç”¨ Kotlin ä»£ç   
<br>

- **ç»“æ„åŒ–å¹¶å‘**  
  Kotlin åç¨‹è®©å¼‚æ­¥ä»£ç åƒåŒæ­¥ä»£ç ä¸€æ ·æ˜“äºä½¿ç”¨  
<br>


#### 3 nullå®‰å…¨
é»˜è®¤æƒ…å†µä¸‹ï¼ŒKotlin å˜é‡ä¸èƒ½æŒæœ‰ null å€¼

è¦ä½¿å˜é‡æŒæœ‰ null å€¼ï¼Œå®ƒå¿…é¡»æ˜¯å¯ä¸º null ç±»å‹ã€‚å¯ä»¥åœ¨å˜é‡ç±»å‹åé¢åŠ ä¸Š ? åç¼€ï¼Œå°†å˜é‡æŒ‡å®šä¸ºå¯ä¸º nullï¼Œè¿™ç§ç±»å‹ä¹‹ååŠ  ? çš„å†™æ³•ï¼Œåœ¨ Kotlin é‡Œå«å¯ç©ºç±»å‹ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤º

```kotlin
val languageName: String? = null
```
<br>

å¯ç©ºç±»å‹åœ¨kotliné‡Œä½¿ç”¨æ—¶è¦ç”¨?.æ¥åˆ¤æ–­
```kotlin
view?.setBackgroundColor(Color.RED)
```
<br>

å»¶æ—¶åˆå§‹åŒ–
```kotlin
lateinit var view: View
```
è¿™ä¸ª lateinit çš„æ„æ€æ˜¯ï¼šå‘Šè¯‰ç¼–è¯‘å™¨æˆ‘æ²¡æ³•ç¬¬ä¸€æ—¶é—´å°±åˆå§‹åŒ–ï¼Œä½†æˆ‘è‚¯å®šä¼šåœ¨ä½¿ç”¨å®ƒä¹‹å‰å®Œæˆåˆå§‹åŒ–çš„ï¼ŒåŠ äº†è¿™ä¸ª lateinit å…³é”®å­—ï¼Œè¿™ä¸ªå˜é‡çš„åˆå§‹åŒ–å°±å…¨é ä½ è‡ªå·±äº†ï¼Œç¼–è¯‘å™¨ä¸å¸®ä½ æ£€æŸ¥äº†
<br>

#### 4 å˜é‡å£°æ˜
Kotlin ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„å…³é”®å­—ï¼ˆå³ val å’Œ varï¼‰æ¥å£°æ˜å˜é‡
- val åªè¯»å˜é‡ï¼Œç”¨äºå€¼ä»ä¸æ›´æ”¹çš„å˜é‡ã€‚ä½¿ç”¨ val å£°æ˜çš„å˜é‡æ— æ³•é‡æ–°èµ‹å€¼ã€‚
- var ç”¨äºå€¼å¯ä»¥æ›´æ”¹çš„å˜é‡
<br>

#### 5 ç±»å‹æ¨æ–­
Kotlin æœ‰ä¸ªå¾ˆæ–¹ä¾¿çš„åœ°æ–¹æ˜¯ï¼Œå¦‚æœä½ åœ¨å£°æ˜çš„æ—¶å€™å°±èµ‹å€¼ï¼Œé‚£ä¸å†™å˜é‡ç±»å‹ä¹Ÿè¡Œ

è¿™ä¸ªç‰¹æ€§å«åšã€Œç±»å‹æ¨æ–­ã€ï¼Œå®ƒè·ŸåŠ¨æ€ç±»å‹æ˜¯ä¸ä¸€æ ·çš„ï¼Œã€ŒåŠ¨æ€ç±»å‹ã€æ˜¯æŒ‡å˜é‡çš„ç±»å‹åœ¨è¿è¡Œæ—¶å¯ä»¥æ”¹å˜ï¼›è€Œã€Œç±»å‹æ¨æ–­ã€æ˜¯ä½ åœ¨ä»£ç é‡Œä¸ç”¨å†™å˜é‡ç±»å‹ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šå¸®ä½ è¡¥ä¸Šã€‚å› æ­¤ï¼ŒKotlin æ˜¯ä¸€é—¨é™æ€è¯­è¨€
<br>

#### 6 æ¡ä»¶è¯­å¥
if-else è¯­å¥ç®€å†™
```kotlin
val answerString: String = if (count == 42) {
    "I have the answer."
} else if (count > 35) {
    "The answer is close."
} else {
    "The answer eludes me."
}

println(answerString)
```
æ¯ä¸ªæ¡ä»¶åˆ†æ”¯éƒ½éšå¼åœ°è¿”å›å…¶æœ€åä¸€è¡Œçš„è¡¨è¾¾å¼çš„ç»“æœï¼Œå› æ­¤æ— éœ€ä½¿ç”¨ return å…³é”®å­—

when è¡¨è¾¾å¼
```kotlin
val answerString = when {
    count == 42 -> "I have the answer."
    count > 35 -> "The answer is close."
    else -> "The answer eludes me."
}

println(answerString)
```

**kotlinä¸­æ²¡æœ‰ä¸‰å…ƒè¿ç®—ç¬¦**
<br>


#### 7 å‡½æ•°
æ™®é€šå‡½æ•°
```kotlin
fun generateAnswerString(countThreshold: Int): String {
    val answerString = if (count > countThreshold) {
        "I have the answer."
    } else {
        "The answer eludes me."
    }

    return answerString
}
```

**é«˜é˜¶å‡½æ•° High-order functions**
å‚æ•°æˆ–è€…è¿”å›å€¼ä¸ºå‡½æ•°ç±»å‹çš„å‡½æ•°ï¼Œç§°ä¸ºé«˜é˜¶å‡½æ•°ï¼Œé«˜é˜¶å‡½æ•°å’Œjavaä¸­å›è°ƒæ¥å£ç±»ä¼¼

ä¸‹é¢æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°çš„ç¤ºä¾‹
```kotlin
fun stringMapper(str: String, mapper: (String) -> Int): Int {
    // Invoke function
    return mapper(str)
}
```

è°ƒç”¨ç¤ºä¾‹
```kotlin
stringMapper("Android", { input ->
    input.length
})
```

å¦‚æœåŒ¿åå‡½æ•°æ˜¯åœ¨æŸä¸ªå‡½æ•°ä¸Šå®šä¹‰çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œåˆ™æ‚¨å¯ä»¥åœ¨ç”¨äºè°ƒç”¨è¯¥å‡½æ•°çš„åœ†æ‹¬å·ä¹‹å¤–ä¼ é€’å®ƒ
```kotlin
stringMapper("Android") { input ->
    input.length
}
```

inputå‚æ•°ä¹Ÿå¯ä»¥çœç•¥ï¼Œé»˜è®¤æ˜¯it
<br>

#### 8 ç±»å‹åˆ¤æ–­å’Œå¼ºè½¬
ä½¿ç”¨ is å…³é”®å­—è¿›è¡Œã€Œç±»å‹åˆ¤æ–­ã€ï¼Œå¹¶ä¸”å› ä¸ºç¼–è¯‘å™¨èƒ½å¤Ÿè¿›è¡Œç±»å‹æ¨æ–­ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬çœç•¥å¼ºè½¬çš„å†™æ³•
```kotlin
fun main() {
    var activity: Activity = NewActivity()
    if (activity is NewActivity) {
        // ğŸ‘‡çš„å¼ºè½¬ç”±äºç±»å‹æ¨æ–­è¢«çœç•¥äº†
        activity.action()
    }
}
```

é‚£ä¹ˆèƒ½ä¸èƒ½ä¸è¿›è¡Œç±»å‹åˆ¤æ–­ï¼Œç›´æ¥è¿›è¡Œå¼ºè½¬è°ƒç”¨å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ as å…³é”®å­—
```kotlin
fun main() {
    var activity: Activity = NewActivity()
    (activity as NewActivity).action()
}
```

å®‰å…¨çš„å¼ºè½¬
```kotlin
fun main() {
    var activity: Activity = NewActivity()
    // ğŸ‘‡'(activity as? NewActivity)' ä¹‹åæ˜¯ä¸€ä¸ªå¯ç©ºç±»å‹çš„å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä½¿ç”¨ '?.' æ¥è°ƒç”¨
    (activity as? NewActivity)?.action()
}
```
<br>

#### 9 é™æ€æ–¹æ³•å’Œå¸¸é‡ç›¸å…³

**companionä¼´ç”Ÿå¯¹è±¡**
Java é™æ€å˜é‡å’Œæ–¹æ³•çš„ç­‰ä»·å†™æ³•ï¼šcompanion object å˜é‡å’Œå‡½æ•°
```kotlin
class A {
    companion object {
        var c: Int = 0
    }
}
```
è°ƒç”¨
```kotlin
A.c
```

é™æ€åˆå§‹åŒ–
```kotlin
class Sample {
    companion object {
        init {
            ...
        }
    }
}
```
<br>

**object**
object ä¸æ˜¯ç±»ï¼Œåƒ class ä¸€æ ·åœ¨ Kotlin ä¸­å±äºå…³é”®å­—ï¼Œåˆ›å»ºä¸€ä¸ªç±»ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªè¿™ä¸ªç±»çš„å¯¹è±¡ã€‚è¿™ä¸ªå°±æ˜¯ object çš„æ„æ€ï¼šå¯¹è±¡
```kotlin
object Sample {
    val name = "A name"
}
```
è°ƒç”¨
```kotlin
Sample.name
```

ç±»ä¼¼javaä¸­çš„å•ä¾‹ç±»
<br>

**é¡¶å±‚å£°æ˜ top-level declaration**
é™¤äº†é™æ€å‡½æ•°è¿™ç§ç®€ä¾¿çš„è°ƒç”¨æ–¹å¼ï¼ŒKotlin è¿˜æœ‰æ›´æ–¹ä¾¿çš„ä¸œè¥¿ï¼šã€Œtop-level declaration é¡¶å±‚å£°æ˜ã€ã€‚å…¶å®å°±æ˜¯æŠŠå±æ€§å’Œå‡½æ•°çš„å£°æ˜ä¸å†™åœ¨ class é‡Œé¢ï¼Œè¿™ä¸ªåœ¨ Kotlin é‡Œæ˜¯å…è®¸çš„
```kotlin
package com.hencoder.plus

// ğŸ‘‡ å±äº packageï¼Œä¸åœ¨ class/object å†…
fun topLevelFuncion() {
}

val topLevelFied = "xxx"
```
è¿™æ ·å†™çš„å±æ€§å’Œå‡½æ•°ï¼Œä¸å±äºä»»ä½• classï¼Œè€Œæ˜¯ç›´æ¥å±äº packageï¼Œå®ƒå’Œé™æ€å˜é‡ã€é™æ€å‡½æ•°ä¸€æ ·æ˜¯å…¨å±€çš„ï¼Œä½†ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼šä½ åœ¨å…¶å®ƒåœ°æ–¹ç”¨çš„æ—¶å€™ï¼Œå°±è¿ç±»åéƒ½ä¸ç”¨å†™


#### 10 const å’Œ val
- Kotlin çš„å¸¸é‡å¿…é¡»å£°æ˜åœ¨å¯¹è±¡ï¼ˆåŒ…æ‹¬ä¼´ç”Ÿå¯¹è±¡ï¼‰æˆ–è€…ã€Œtop-level é¡¶å±‚ã€ä¸­ï¼Œå› ä¸ºå¸¸é‡æ˜¯é™æ€çš„
- Kotlin ä¸­åªæœ‰åŸºæœ¬ç±»å‹å’Œ String ç±»å‹å¯ä»¥å£°æ˜æˆå¸¸é‡

åŒºåˆ«


```kotlin
object myObject {
    const val constObject: String = "constObject"
    val normalObject: String = "normalObject"
}
```
æ‰“å¼€Android studio ç‚¹å‡» Tools->Kotlin->Show Kotlin ByteCode

```kotlin
// class version 50.0 (50)
// access flags 0x31
public final class com/example/kotlin/myObject {


  // access flags 0x19
  public final static Ljava/lang/String; constObject = "constObject"
  @Lorg/jetbrains/annotations/NotNull;() // invisible

  // access flags 0x1A
  private final static Ljava/lang/String; normalObject = "normalObject"
  @Lorg/jetbrains/annotations/NotNull;() // invisible

  // access flags 0x11
  public final getNormalObject()Ljava/lang/String;
  @Lorg/jetbrains/annotations/NotNull;() // invisible
   L0
    LINENUMBER 144 L0
    GETSTATIC com/example/kotlin/myObject.normalObject : Ljava/lang/String;
    ARETURN
   L1
    LOCALVARIABLE this Lcom/example/kotlin/myObject; L0 L1 0
    MAXSTACK = 1
    MAXLOCALS = 1

  ......
}
```
ä»å­—èŠ‚ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°const val å’Œvalä¿®é¥°å¯¹è±¡çš„ä¸»è¦åŒºåˆ«æ˜¯
- const val å¯è§æ€§ä¸ºpublic final staticï¼Œå¯ä»¥ç›´æ¥è®¿é—®
- val å¯è§æ€§ä¸ºprivate final staticï¼Œå¹¶ä¸”val ä¼šç”Ÿæˆæ–¹æ³•getNormalObject()ï¼Œé€šè¿‡æ–¹æ³•è°ƒç”¨è®¿é—®
<br>